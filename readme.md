# é‡‘èé£æ§æ¨¡å‹ - å®¢æˆ·é€¾æœŸé¢„æµ‹

![Project Banner](png/image.png)

## ğŸ“Š æ•°æ®é›†è¯´æ˜

### æ•°æ®ç‰¹å¾
| ç‰¹å¾ç±»åˆ« | å˜é‡èŒƒå›´ | æè¿° |
|---------|---------|------|
| å®¢æˆ·åŸºæœ¬ä¿¡æ¯ | x0-x20 | åŒ…å«å®¢æˆ· demographic ä¿¡æ¯ |
| å†å²é‡‘èå€Ÿè´· | x20-x256 | å¾ä¿¡ç³»ç»Ÿä¸­çš„å€Ÿè´·å†å²è®°å½• |
| å…¶ä»–è¡Œä¸ºæ•°æ® | x256-x3805 | å®¢æˆ·å…¶ä»–é‡‘è/æ¶ˆè´¹è¡Œä¸º |

**ç›®æ ‡å˜é‡**ï¼š  
`y=1` è¡¨ç¤ºæˆä¿¡åå‘ç”Ÿé€¾æœŸï¼Œ`y=0` è¡¨ç¤ºæ­£å¸¸è¿˜æ¬¾

### æ•°æ®ç»Ÿè®¡
| æ•°æ®é›† | æ ·æœ¬é‡ | æ­£æ ·æœ¬å æ¯” | æ—¶é—´ç»´åº¦ |
|-------|-------|----------|--------|
| è®­ç»ƒé›† | 62,000 | 18% | åˆ†é˜¶æ®µè®°å½• (`date`å˜é‡) |
| æµ‹è¯•é›† | 18,000 | 11% | ä¸è®­ç»ƒé›†åŒåˆ†å¸ƒ |

![æ•°æ®åˆ†å¸ƒå¯è§†åŒ–](png/image-1.png)
*å›¾ï¼šè®­ç»ƒé›†ä¸æµ‹è¯•é›†çš„æ ·æœ¬åˆ†å¸ƒ*

## ğŸ¯ å»ºæ¨¡ç›®æ ‡
é¢„æµ‹å®¢æˆ·é€¾æœŸæ¦‚ç‡ `P(y=1|x) âˆˆ [0,1]`

**è¾“å‡ºå¤„ç†å»ºè®®**ï¼š
```python
# æ¨¡å‹è¾“å‡ºåå¤„ç†æ–¹æ¡ˆ
prob = torch.sigmoid(logits)  # ç¡®ä¿è¾“å‡ºåœ¨0-1ä¹‹é—´
ğŸ§  æ¨¡å‹æ¶æ„
å½“å‰æœ€ä½³ç»“æ„
mermaid
å¤åˆ¶
graph TD
    A[åŸå§‹ç‰¹å¾] --> B[Patchåˆ†å‰²]
    B --> C[Embeddingå±‚]
    C --> D[ç‰¹å¾æå–å—]
    D --> E[é¢„æµ‹å¤´]
    
    subgraph ç‰¹å¾æå–
    D --> D1[MLP/Transformer]
    D1 --> D2[BatchNorm]
    end
è¶…å‚æ•°å»ºè®®ï¼š

Patché•¿åº¦: 128
Hidden size: 64-256 (éœ€éªŒè¯)
ä½¿ç”¨çº¿æ€§å±‚+æ­£åˆ™åŒ–é˜²æ­¢è¿‡æ‹Ÿåˆ
âš™ï¸ è®­ç»ƒé…ç½®
å…³é”®å‚æ•°
bash
å¤åˆ¶
tensorboard --logdir=risk_control/logs/tensor/
æ³¨æ„äº‹é¡¹
DataLoader ä¼šè‡ªåŠ¨è°ƒç”¨ prepare_data()
æµ‹è¯•é›†è¯„ä¼°éœ€æ‰‹åŠ¨æ‰§è¡Œï¼š
python
å¤åˆ¶
trainer.test(model)
æ—¥å¿—è®°å½•åŒºåˆ† on_step å’Œ on_epoch
ğŸ” å®éªŒè®°å½•
é‡‡æ ·ç­–ç•¥å¯¹æ¯”
æ–¹æ³•	å‡†ç¡®ç‡	å¬å›ç‡	å¤‡æ³¨
åŸå§‹æ•°æ®	0.633	0.551	Baseline
æ¬ é‡‡æ ·	0.618	0.573	éœ€éªŒè¯æ­£æ ·æœ¬é‡
é˜ˆå€¼è°ƒæ•´	0.590	0.636	æœ€ä½³å¹³è¡¡
NNIè¶…å‚æœç´¢
bash
å¤åˆ¶
nnictl create --config config.yaml --port 8080
ç®—æ³•å¯¹æ¯”è¡¨ï¼š

ç®—æ³•	ä¼˜ç‚¹	ç¼ºç‚¹	å®‰è£…
TPE	è½»é‡çº§è´å¶æ–¯ä¼˜åŒ–	å¿½ç•¥å‚æ•°å…³è”	å†…ç½®
SMAC	å¤„ç†åˆ†ç±»å˜é‡å¥½	ä¾èµ–éšæœºæ£®æ—	pip install nni[SMAC]
BOHB	ç»„åˆHyperband+TPE	è®¡ç®—æˆæœ¬é«˜	å†…ç½®
png/image111.png

ğŸš€ ä½¿ç”¨æŒ‡å—
å®‰è£…ä¾èµ–ï¼š
bash
å¤åˆ¶
pip install -r requirements.txt
å¯åŠ¨è®­ç»ƒï¼š
bash
å¤åˆ¶
python train.py --config configs/base.yaml
ç›‘æ§å®éªŒï¼š
bash
å¤åˆ¶
tensorboard --logdir=logs/
ğŸ“Œ å¾…è§£å†³é—®é¢˜
 éªŒè¯æ¬ é‡‡æ ·åçš„æ­£æ ·æœ¬æ¯”ä¾‹
 ä¼˜åŒ–patch-basedç‰¹å¾æå–å±‚
 æµ‹è¯•ä¸åŒhidden_sizeçš„å½±å“